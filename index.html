<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A Sliding Windows Regression model with parameterized
    Gaussian kernels as weights for hydrological inference. The package is
    currently under development.">
<title>Gaussian Sliding Windows Regression • SlidingWindowReg</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Gaussian Sliding Windows Regression">
<meta property="og:description" content="A Sliding Windows Regression model with parameterized
    Gaussian kernels as weights for hydrological inference. The package is
    currently under development.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">SlidingWindowReg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/sampleExperiment.html">Sample experiment using Sliding Window Regression</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="slidingwindowreg-package">SlidingWindowReg package<a class="anchor" aria-label="anchor" href="#slidingwindowreg-package"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="a-gaussian-sliding-windows-regression-model">A Gaussian Sliding Windows Regression Model<a class="anchor" aria-label="anchor" href="#a-gaussian-sliding-windows-regression-model"></a>
</h2>
<p>This R package presents a Sliding Windows Regression model with Gaussian kernels for hydrological inference, see <a href="https://arxiv.org/abs/2306.00453" class="external-link">Schrunner et al. (2023)</a>. Given an input time series <span class="math inline">(<em>x</em><sub><em>t</em></sub>)_<em>t</em> ∈ <em>T</em></span> (describing rainfall in a hydrological setting) and a time-dependent target variable <span class="math inline">(<em>y</em><sub><em>t</em></sub>)_<em>t</em> ∈ <em>T</em></span> describing the gauged watershed runoff, the model utilizes a set of <span class="math inline"><em>k</em></span> lagged time windows to model one water path each. For instance, surface flow, characterized by short time lags, may be represented by the first window, while groundwater flow is described by a second window with longer time lags.</p>
<p>A lagged time window <span class="math inline"><em>W</em></span> is an interval on the time axis bounded by time lags <span class="math inline"><em>s</em><sub>min</sub> &lt; <em>s</em><sub>max</sub></span> relative to the current time point <span class="math inline"><em>t</em></span>,</p>
<p><span class="math display"><em>W</em> = [<em>t</em>−<em>s</em><sub>max</sub>,<em>t</em>−<em>s</em><sub>min</sub>].</span></p>
<p>Instead of <span class="math inline"><em>s</em><sub>min</sub></span> and <span class="math inline"><em>s</em><sub>max</sub></span>, <span class="math inline"><em>W</em></span> is represented by the following parameters for simplicity:</p>
<ul>
<li>a location parameter <span class="math display">$$\delta = \frac{s_{\min} + s_{\max}}{2}$$</span> indicating the window center on the time axis, i.e. the distance between the window center and the estimated time point on the time axis, and</li>
<li>a size parameter <span class="math display">$$\sigma = \lceil \frac{s_{\max}-s_{\min}}{6} \rceil$$</span> defining the width of the window.</li>
</ul>
<p>Given such a window <span class="math inline"><em>W</em><sub><em>i</em></sub></span>, we define a Gaussian kernel <span class="math inline"><em>κ</em><sup>(<em>i</em>)</sup></span> as a weight vector approximating the shape of a Gaussian probability density function <span class="math inline"><em>φ</em></span> with mean <span class="math inline"><em>μ</em> = <em>δ</em><sub><em>i</em></sub></span> and standard deviation <span class="math inline"><em>σ</em></span>. The predicted runoff associated with window <span class="math inline"><em>i</em></span> is then computed as the convolution of the input time series <span class="math inline">(<em>x</em><sub><em>t</em></sub>)_<em>t</em> ∈ <em>T</em></span> with the window kernel <span class="math inline"><em>κ</em><sup>(<em>i</em>)</sup></span> as weight vector, i.e. <span class="math inline"><em>κ</em><sup>(<em>i</em>)</sup> * <em>x</em><sub><em>W</em><sub><em>i</em></sub></sub></span>, where <span class="math inline"><em>x</em><sub><em>W</em></sub> = (<em>x</em><sub><em>t</em> − <em>s</em><sub>max</sub></sub>,…,<em>x</em><sub><em>t</em> − <em>s</em><sub>min</sub></sub>)</span> denotes the vector of lagged observations and <span class="math inline">*</span> denotes the convolution operator.</p>
<p>Overall, the predicted output <span class="math inline"><em>y</em><sub><em>t</em></sub></span> is modeled as a multiple linear regression model</p>
<p><span class="math display">$$ y_t = \sum\limits_{i=1}^{k} \beta_i \left(\kappa^{(i)} \ast x_{W_i}\right) + \varepsilon_t, $$</span></p>
<p>where <span class="math inline"><em>ε</em><sub><em>t</em></sub></span> denotes the model error. Due to practical considerations, we restrict regression parameters <span class="math inline"><em>β</em><sub>1</sub>, …, <em>β</em><sub><em>k</em></sub></span> to non-negative numbers.</p>
</div>
<div class="section level2">
<h2 id="package-structure">Package structure<a class="anchor" aria-label="anchor" href="#package-structure"></a>
</h2>
<p>The core functionality of the package consists of functions <tt>train</tt> and <tt>predict</tt>, which perform the model fitting and forecasting steps, respectively. Further, functions for evaluating and plotting model results and parameters are provided.</p>
<p>The implementation builds on an S3 class <tt>SWR</tt>, which implements multiple generic functions, such as <tt>summary</tt>, <tt>plot</tt>, <tt>coef</tt>, <tt>dim</tt>, <tt>AIC</tt>, or <tt>BIC</tt>. Further, evaluation metrics can be computed using <tt>eval_all</tt>, which calls regression performance metrics <tt>rmse</tt> (root mean square error, RMSE), <tt>nrmse</tt> (normalized RMSE), <tt>r2</tt> (coefficient of determination), as well as hydrological metrics <tt>nse</tt> (Nash-Sutcliffe efficiency) and <tt>kge</tt> (Kling-Gupta efficientcy). Plots are provided for the kernel vectors <span class="math inline"><em>κ</em><sup>(<em>i</em>)</sup></span> via <tt>plot_kernel</tt>, as well as for the predictions using <tt>plot_prediction</tt>.</p>
<p>A sample dataset <tt>sampleWatershed</tt> is contained in the package. The data originates from a real-world watershed in Cowichan, British Columbia, Canada and contains daily precipitation (input time series), as well as gauged runoff (output time series). Both time series cover a period of 39 hydrological years, starting on October 01, 1979.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This version of the R package can be installed as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>  remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"sschrunner/SlidingWindowReg"</span>, <span class="at">build_manual =</span> <span class="cn">TRUE</span>, <span class="at">build_vignettes =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<ul>
<li>R (&gt;= 3.5.0)</li>
<li>combinat,</li>
<li>dplyr,</li>
<li>ggplot2,</li>
<li>hydroGOF,</li>
<li>knitr,</li>
<li>methods,</li>
<li>nloptr,</li>
<li>parallel,</li>
<li>pbapply,</li>
<li>rdist,</li>
<li>Rdpack (&gt;= 0.7),</li>
<li>stats,</li>
<li>lifecycle</li>
</ul>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <tt>SlidingWindowReg</tt> in a report or scientific publication, we would appreciate citations to the following preprint:</p>
<p>Schrunner, S. et al. (2023). A Gaussian Sliding Windows Regression Model for Hydrological Inference. arXiv.org (preprint), 2023, <a href="https://doi.org/10.48550/arXiv.2306.00453" class="external-link uri">https://doi.org/10.48550/arXiv.2306.00453</a></p>
<p>Bibtex entry:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>misc{schrunner2023gaussian,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  title<span class="ot">=</span>{A Gaussian Sliding Windows Regression Model <span class="cf">for</span> Hydrological Inference}, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  author<span class="ot">=</span>{Stefan Schrunner and Joseph Janssen and Anna Jenul and Jiguo Cao and Ali A. Ameli and William J. Welch},</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  year<span class="ot">=</span>{<span class="dv">2023</span>},</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  howpublished<span class="ot">=</span>{<span class="fu">arXiv.org</span> (preprint)},</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  eprint<span class="ot">=</span>{<span class="fl">2306.00453</span>},</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  archivePrefix<span class="ot">=</span>{arXiv},</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  primaryClass<span class="ot">=</span>{stat.ME},</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  doi<span class="ot">=</span>{<span class="fl">10.48550</span><span class="sc">/</span>arXiv.<span class="fl">2306.00453</span>},</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  url<span class="ot">=</span>{https<span class="sc">:</span><span class="er">//</span>doi.org<span class="sc">/</span><span class="fl">10.48550</span><span class="sc">/</span>arXiv.<span class="fl">2306.00453</span>}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>The implemented Gaussian Sliding Windows Regression model was developed in collaboration between</p>
<ul>
<li>Norwegian University of Life Sciences (NMBU), Ås, Norway,</li>
<li>University of British Columbia (UBC), Vancouver, Canada, and</li>
<li>Simon Fraser University (SFU), Burnaby, Canada</li>
</ul>
<p>This package is currently under development. For issues, feel free to contact <a href="mailto:stefan.schrunner@nmbu.no">Stefan Schrunner</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SlidingWindowReg</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stefan Schrunner <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1327-4855" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/sschrunner/SlidingWindowReg/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/sschrunner/SlidingWindowReg/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stefan Schrunner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
