<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Gaussian Sliding Windows Regression • SlidingWindowReg</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Gaussian Sliding Windows Regression">
<meta name="description" content="A Sliding Windows Regression model with parameterized Gaussian kernels as weights for hydrological inference. The package is currently under development.">
<meta property="og:description" content="A Sliding Windows Regression model with parameterized Gaussian kernels as weights for hydrological inference. The package is currently under development.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">SlidingWindowReg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/sampleExperiment.html">Sample experiment using Sliding Window Regression</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="slidingwindowreg-package">SlidingWindowReg package<a class="anchor" aria-label="anchor" href="#slidingwindowreg-package"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="a-gaussian-sliding-windows-regression-model">A Gaussian Sliding Windows Regression Model<a class="anchor" aria-label="anchor" href="#a-gaussian-sliding-windows-regression-model"></a>
</h2>
<p>This R package presents a Sliding Windows Regression model with Gaussian kernels for hydrological inference, see <a href="https://arxiv.org/abs/2306.00453" class="external-link">Schrunner et al. (2023)</a>. Given an input time series <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>_</mi><mrow><mi>t</mi><mo>∈</mo><mi>T</mi></mrow></mrow><annotation encoding="application/x-tex">(x_t)\_{t \in T}</annotation></semantics></math> (describing rainfall in a hydrological setting) and a time-dependent target variable <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>_</mi><mrow><mi>t</mi><mo>∈</mo><mi>T</mi></mrow></mrow><annotation encoding="application/x-tex">(y_t)\_{t \in T}</annotation></semantics></math> describing the gauged watershed runoff, the model utilizes a set of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math> lagged time windows to model one water path each. For instance, surface flow, characterized by short time lags, may be represented by the first window, while groundwater flow is described by a second window with longer time lags.</p>
<p>A lagged time window <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math> is an interval on the time axis bounded by time lags <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mo>min</mo></msub><mo>&lt;</mo><msub><mi>s</mi><mo>max</mo></msub></mrow><annotation encoding="application/x-tex">s_{\min} &lt; s_{\max}</annotation></semantics></math> relative to the current time point <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>t</mi><mo>−</mo><msub><mi>s</mi><mo>max</mo></msub><mo>,</mo><mi>t</mi><mo>−</mo><msub><mi>s</mi><mo>min</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">W = [t-s_{\max},t-s_{\min}].</annotation></semantics></math></p>
<p>Instead of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mo>min</mo></msub><annotation encoding="application/x-tex">s_{\min}</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mo>max</mo></msub><annotation encoding="application/x-tex">s_{\max}</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>W</mi><annotation encoding="application/x-tex">W</annotation></semantics></math> is represented by the following parameters for simplicity:</p>
<ul>
<li>a location parameter <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mfrac><mrow><msub><mi>s</mi><mo>min</mo></msub><mo>+</mo><msub><mi>s</mi><mo>max</mo></msub></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\delta = \frac{s_{\min} + s_{\max}}{2}</annotation></semantics></math> indicating the window center on the time axis, i.e. the distance between the window center and the estimated time point on the time axis, and</li>
<li>a size parameter <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mo stretchy="false" form="prefix">⌈</mo><mfrac><mrow><msub><mi>s</mi><mo>max</mo></msub><mo>−</mo><msub><mi>s</mi><mo>min</mo></msub></mrow><mn>6</mn></mfrac><mo stretchy="false" form="postfix">⌉</mo></mrow><annotation encoding="application/x-tex">\sigma = \lceil \frac{s_{\max}-s_{\min}}{6} \rceil</annotation></semantics></math> defining the width of the window.</li>
</ul>
<p>Given such a window <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>i</mi></msub><annotation encoding="application/x-tex">W_i</annotation></semantics></math>, we define a Gaussian kernel <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>κ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\kappa^{(i)}</annotation></semantics></math> as a weight vector approximating the shape of a Gaussian probability density function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>φ</mi><annotation encoding="application/x-tex">\varphi</annotation></semantics></math> with mean <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><msub><mi>δ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mu=\delta_i</annotation></semantics></math> and standard deviation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>. The predicted runoff associated with window <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> is then computed as the convolution of the input time series <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>_</mi><mrow><mi>t</mi><mo>∈</mo><mi>T</mi></mrow></mrow><annotation encoding="application/x-tex">\left(x_t\right)\_{t\in T}</annotation></semantics></math> with the window kernel <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>κ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\kappa^{(i)}</annotation></semantics></math> as weight vector, i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>κ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>*</mo><msub><mi>x</mi><msub><mi>W</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">\kappa^{(i)} \ast x_{W_i}</annotation></semantics></math>, where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>W</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><msub><mi>s</mi><mo>max</mo></msub></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><msub><mi>s</mi><mo>min</mo></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x_W = (x_{t-s_{\max}},\dots,x_{t-s_{\min}})</annotation></semantics></math> denotes the vector of lagged observations and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>*</mo><annotation encoding="application/x-tex">\ast</annotation></semantics></math> denotes the convolution operator.</p>
<p>Overall, the predicted output <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">y_t</annotation></semantics></math> is modeled as a multiple linear regression model</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>β</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>κ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>*</mo><msub><mi>x</mi><msub><mi>W</mi><mi>i</mi></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>ε</mi><mi>t</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex"> y_t = \sum\limits_{i=1}^{k} \beta_i \left(\kappa^{(i)} \ast x_{W_i}\right) + \varepsilon_t, </annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ε</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math> denotes the model error. Due to practical considerations, we restrict regression parameters <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\beta_1,\dots,\beta_k</annotation></semantics></math> to non-negative numbers.</p>
</div>
<div class="section level2">
<h2 id="package-structure">Package structure<a class="anchor" aria-label="anchor" href="#package-structure"></a>
</h2>
<p>The core functionality of the package consists of functions <tt>train</tt> and <tt>predict</tt>, which perform the model fitting and forecasting steps, respectively. Further, functions for evaluating and plotting model results and parameters are provided.</p>
<p>The implementation builds on an S3 class <tt>SWR</tt>, which implements multiple generic functions, such as <tt>summary</tt>, <tt>plot</tt>, <tt>coef</tt>, <tt>dim</tt>, <tt>AIC</tt>, or <tt>BIC</tt>. Further, evaluation metrics can be computed using <tt>eval_all</tt>, which calls regression performance metrics <tt>rmse</tt> (root mean square error, RMSE), <tt>nrmse</tt> (normalized RMSE), <tt>r2</tt> (coefficient of determination), as well as hydrological metrics <tt>nse</tt> (Nash-Sutcliffe efficiency) and <tt>kge</tt> (Kling-Gupta efficientcy). Plots are provided for the kernel vectors <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>κ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\kappa^{(i)}</annotation></semantics></math> via <tt>plot_kernel</tt>, as well as for the predictions using <tt>plot_prediction</tt>.</p>
<p>A sample dataset <tt>sampleWatershed</tt> is contained in the package. The data originates from a real-world watershed in Cowichan, British Columbia, Canada and contains daily precipitation (input time series), as well as gauged runoff (output time series). Both time series cover a period of 39 hydrological years, starting on October 01, 1979.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This version of the R package can be installed as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>  remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"sschrunner/SlidingWindowReg"</span>, <span class="at">build_manual =</span> <span class="cn">TRUE</span>, <span class="at">build_vignettes =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<ul>
<li>R (&gt;= 3.5.0)</li>
<li>combinat,</li>
<li>dplyr,</li>
<li>ggplot2,</li>
<li>hydroGOF,</li>
<li>knitr,</li>
<li>lifecycle,</li>
<li>methods,</li>
<li>nloptr,</li>
<li>rgenoud,</li>
<li>parallel,</li>
<li>pbapply,</li>
<li>rdist,</li>
<li>Rdpack (&gt;= 0.7),</li>
<li>stats</li>
</ul>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <tt>SlidingWindowReg</tt> in a report or scientific publication, we would appreciate citations to the following preprint:</p>
<p>Schrunner, S. et al. (2023). A Gaussian Sliding Windows Regression Model for Hydrological Inference. arXiv.org (preprint), 2023, <a href="https://doi.org/10.48550/arXiv.2306.00453" class="external-link uri">https://doi.org/10.48550/arXiv.2306.00453</a></p>
<p>Bibtex entry:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="sc">@</span>misc{schrunner2023gaussian,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  title<span class="ot">=</span>{A Gaussian Sliding Windows Regression Model <span class="cf">for</span> Hydrological Inference}, </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  author<span class="ot">=</span>{Stefan Schrunner and Joseph Janssen and Anna Jenul and Jiguo Cao and Ali A. Ameli and William J. Welch},</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  year<span class="ot">=</span>{<span class="dv">2023</span>},</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  howpublished<span class="ot">=</span>{<span class="fu">arXiv.org</span> (preprint)},</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  eprint<span class="ot">=</span>{<span class="fl">2306.00453</span>},</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  archivePrefix<span class="ot">=</span>{arXiv},</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  primaryClass<span class="ot">=</span>{stat.ME},</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  doi<span class="ot">=</span>{<span class="fl">10.48550</span><span class="sc">/</span>arXiv.<span class="fl">2306.00453</span>},</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  url<span class="ot">=</span>{https<span class="sc">:</span><span class="er">//</span>doi.org<span class="sc">/</span><span class="fl">10.48550</span><span class="sc">/</span>arXiv.<span class="fl">2306.00453</span>}</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>The implemented Gaussian Sliding Windows Regression model was developed in collaboration between</p>
<ul>
<li>Norwegian University of Life Sciences (NMBU), Ås, Norway,</li>
<li>University of British Columbia (UBC), Vancouver, Canada, and</li>
<li>Simon Fraser University (SFU), Burnaby, Canada</li>
</ul>
<p>This package is currently under development. For issues, feel free to contact <a href="mailto:stefan.schrunner@nmbu.no">Stefan Schrunner</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SlidingWindowReg</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stefan Schrunner <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1327-4855" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/sschrunner/SlidingWindowReg/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/sschrunner/SlidingWindowReg/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefan Schrunner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
